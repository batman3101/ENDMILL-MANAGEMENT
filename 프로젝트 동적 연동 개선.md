# í”„ë¡œì íŠ¸ ë™ì  ì—°ë™ ê°œì„  ê³„íš

## ğŸ“Œ ê°œìš”

í˜„ì¬ ì‹œìŠ¤í…œì€ CAM Sheet ê¸°ë°˜ì˜ ì •ì  ì •ë³´ë§Œ í‘œì‹œí•˜ê³  ìˆìœ¼ë©°, ì„¤ë¹„ì˜ ì‹¤ì‹œê°„ ìƒì‚° ìƒíƒœì™€ ì•¤ë“œë°€ ì •ë³´ê°€ ì—°ë™ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ë³¸ ë¬¸ì„œëŠ” PRDì— ëª…ì‹œëœ "ëª¨ë“  ëª¨ë“ˆì´ ì„œë¡œ ê¸´ë°€í•œ ê´€ê³„ì„±ì„ ê°€ì ¸ì•¼ í•œë‹¤"ëŠ” ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±í•˜ê¸° ìœ„í•œ ìˆ˜ì • ê³„íšì…ë‹ˆë‹¤.

---

## ğŸ” 1ë‹¨ê³„: í˜„ì¬ ë¬¸ì œ ë¶„ì„

### í˜„ì¬ ë°ì´í„° êµ¬ì¡°ì˜ ë¬¸ì œì 

```
âŒ í˜„ì¬ (ë¶„ë¦¬ëœ êµ¬ì¡°):

CAM Sheet ì˜ì—­ (ì •ì )          ì„¤ë¹„ ì˜ì—­ (ë™ì )
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ cam_sheets      â”‚           â”‚ equipment       â”‚
â”‚ - model         â”‚           â”‚ - current_model â”‚
â”‚ - process       â”‚           â”‚ - process       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                             â”‚
         â–¼                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚cam_sheet_endmillsâ”‚          â”‚ tool_positions  â”‚
â”‚ - endmill_code  â”‚           â”‚ - endmill_type_idâ”‚
â”‚ - tool_life     â”‚           â”‚ - current_life  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ëŠ” ì™¼ìª½ë§Œ ì¡°íšŒ â†’ ì‹¤ì‹œê°„ ì •ë³´ ì—†ìŒ
```

### êµ¬ì²´ì  ë¬¸ì œ ì‹œë‚˜ë¦¬ì˜¤

**ìƒí™©:**
- ì„¤ë¹„ C001ì´ ì–´ì œê¹Œì§€ PA1+CNC1 ìƒì‚°
- ì˜¤ëŠ˜ R13+CNC2ë¡œ ë³€ê²½
- AL002 ì•¤ë“œë°€ì´ C001ì— ì¥ì°©ë¨

**í˜„ì¬ ë™ì‘:**
- equipment í…Œì´ë¸”ë§Œ ì—…ë°ì´íŠ¸: `current_model=R13, process=CNC2`
- cam_sheet_endmills í…Œì´ë¸”ì€ ë³€ê²½ ì—†ìŒ
- ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ëŠ” CAM Sheet ì •ë³´ë§Œ ë³´ì—¬ì¤Œ (PA1+CNC1, R13+CNC2 ë‘˜ ë‹¤ í‘œì‹œ)
- ì‹¤ì œ C001ì´ R13+CNC2ë¡œ ë³€ê²½ëœ ì‚¬ì‹¤ì´ ë°˜ì˜ë˜ì§€ ì•ŠìŒ

---

## ğŸ¯ 2ë‹¨ê³„: ëª©í‘œ ì•„í‚¤í…ì²˜ ì„¤ê³„

### í•„ìš”í•œ ë°ì´í„° ê´€ê³„

```
âœ… ëª©í‘œ (í†µí•©ëœ êµ¬ì¡°):

                ì•¤ë“œë°€ íƒ€ì…
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚endmill_typesâ”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼              â–¼              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚CAM Sheetâ”‚  â”‚ì„¤ë¹„ ì¥ì°©  â”‚  â”‚ì¬ê³       â”‚
   â”‚ë§¤í•‘     â”‚  â”‚ìƒíƒœ      â”‚  â”‚         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   (ì‚¬ì–‘ ì •ë³´)  (ì‹¤ì‹œê°„ ìœ„ì¹˜) (ìˆ˜ëŸ‰ ì •ë³´)
```

### í†µí•© í›„ ì •ë³´ íë¦„

1. **ì•¤ë“œë°€ â†’ ì„¤ë¹„ ì¡°íšŒ**: ì–´ë–¤ ì„¤ë¹„ì—ì„œ í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ì§€
2. **ì„¤ë¹„ â†’ ì•¤ë“œë°€ ì¡°íšŒ**: í˜„ì¬ ì¥ì°©ëœ ì•¤ë“œë°€ ëª©ë¡
3. **CAM Sheet ì‚¬ì–‘ ì—°ë™**: ì„¤ë¹„ì˜ ëª¨ë¸/ê³µì •ì— ë§ëŠ” ì‚¬ì–‘ ìë™ ì ìš©
4. **ì‹¤ì‹œê°„ ìˆ˜ëª… ì¶”ì **: ì„¤ë¹„ë³„ ì•¤ë“œë°€ ì‚¬ìš© í˜„í™©

---

## ğŸ“‹ 3ë‹¨ê³„: ìˆ˜ì •ì´ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ íŒŒì•…

### ì˜í–¥ë°›ëŠ” í˜ì´ì§€/API

#### 1. ì•¤ë“œë°€ ê´€ë¦¬ í˜ì´ì§€
- âœ… í˜„ì¬: CAM Sheet ë§¤í•‘ ì •ë³´ë§Œ í‘œì‹œ
- ğŸ”§ ì¶”ê°€: í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ ì„¤ë¹„ í‘œì‹œ
- ğŸ”§ ì¶”ê°€: ì„¤ë¹„ë³„ Tool Life ì‹¤ì‹œê°„ í‘œì‹œ

#### 2. ì„¤ë¹„ ê´€ë¦¬ í˜ì´ì§€
- âœ… í˜„ì¬: ì„¤ë¹„ ê¸°ë³¸ ì •ë³´ë§Œ í‘œì‹œ
- ğŸ”§ ì¶”ê°€: í˜„ì¬ ëª¨ë¸/ê³µì •ì— ë§ëŠ” CAM Sheet ìë™ ì—°ê²°
- ğŸ”§ ì¶”ê°€: ì¥ì°©ëœ ì•¤ë“œë°€ ì‹¤ì‹œê°„ í‘œì‹œ

#### 3. ê³µêµ¬ êµì²´ í˜ì´ì§€
- âœ… í˜„ì¬: tool_changes í…Œì´ë¸”ë§Œ ê¸°ë¡
- ğŸ”§ ì¶”ê°€: tool_positions ì—…ë°ì´íŠ¸
- ğŸ”§ ì¶”ê°€: ì„¤ë¹„ ëª¨ë¸/ê³µì • ë³€ê²½ ì‹œ CAM Sheet ìë™ ì „í™˜

#### 4. ëŒ€ì‹œë³´ë“œ
- âœ… í˜„ì¬: ì¬ê³  ê¸°ë°˜ í†µê³„ë§Œ í‘œì‹œ
- ğŸ”§ ì¶”ê°€: ì•¤ë“œë°€ë³„ ì‹¤ì œ ì‚¬ìš© ì„¤ë¹„ ê°œìˆ˜
- ğŸ”§ ì¶”ê°€: ëª¨ë¸ë³„ ì•¤ë“œë°€ ì‚¬ìš© í˜„í™©

---

## ğŸ› ï¸ 4ë‹¨ê³„: ë°ì´í„°ë² ì´ìŠ¤ ìˆ˜ì • ê³„íš

### Option 1: tool_positions í…Œì´ë¸” í™œìš© (ê¶Œì¥)

í˜„ì¬ `tool_positions` í…Œì´ë¸” êµ¬ì¡°:
```sql
tool_positions:
  - id (PK)
  - equipment_id (FK â†’ equipment)
  - position_number (T01~T24)
  - endmill_type_id (FK â†’ endmill_types)
  - current_life (í˜„ì¬ ìˆ˜ëª…)
  - total_life (ì´ ìˆ˜ëª…)
  - install_date (ì„¤ì¹˜ì¼)
  - status (ìƒíƒœ: active/inactive)
  - created_at
  - updated_at
```

**ì¥ì :**
- ì´ë¯¸ ëª¨ë“  í•„ìš”í•œ ì •ë³´ê°€ ìˆìŒ
- equipmentì™€ JOINí•˜ë©´ current_model, process í™•ì¸ ê°€ëŠ¥
- ì¶”ê°€ í…Œì´ë¸” ë¶ˆí•„ìš”

**í•„ìš”í•œ ì¿¼ë¦¬ íŒ¨í„´:**
```sql
-- ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€: ì´ ì•¤ë“œë°€ì„ ì‚¬ìš©ì¤‘ì¸ ì„¤ë¹„ ì¡°íšŒ
SELECT
  e.equipment_number,
  e.current_model,
  e.process,
  tp.position_number,
  tp.current_life,
  tp.total_life,
  tp.install_date,
  cs.tool_life as spec_tool_life
FROM tool_positions tp
JOIN equipment e ON tp.equipment_id = e.id
LEFT JOIN cam_sheets cs ON cs.model = e.current_model
  AND cs.process = e.process
LEFT JOIN cam_sheet_endmills cse ON cse.cam_sheet_id = cs.id
  AND cse.endmill_type_id = tp.endmill_type_id
WHERE tp.endmill_type_id = 'AL002_ID'
  AND tp.status = 'active'
```

---

## ğŸ”„ 5ë‹¨ê³„: API ìˆ˜ì • ìˆœì„œ

### Phase 1: API í™•ì¥ (ê¸°ì¡´ ê¸°ëŠ¥ ìœ ì§€)

#### API ìˆ˜ì •: `app/api/endmill/route.ts`

**í˜„ì¬ ì‘ë‹µ:**
```json
{
  "code": "AL002",
  "camSheets": [
    {
      "model": "PA1",
      "process": "CNC1",
      "toolLife": 500,
      "tNumber": 12
    }
  ],
  "inventory": {...}
}
```

**ìˆ˜ì • í›„ ì‘ë‹µ:**
```json
{
  "code": "AL002",
  "camSheets": [
    {
      "model": "PA1",
      "process": "CNC1",
      "toolLife": 500,
      "tNumber": 12
    }
  ],
  "currentUsage": [
    {
      "equipmentNumber": "C001",
      "equipmentModel": "R13",
      "equipmentProcess": "CNC2",
      "positionNumber": 15,
      "currentLife": 450,
      "totalLife": 600,
      "installDate": "2025-10-01",
      "status": "active",
      "specToolLife": 600,
      "usagePercentage": 75
    }
  ],
  "inventory": {...}
}
```

---

## ğŸ“ 6ë‹¨ê³„: êµ¬ì²´ì  ìˆ˜ì • ê³¼ì •

### Step 1: API ë ˆì´ì–´ ìˆ˜ì •

#### íŒŒì¼: `app/api/endmill/route.ts`

```typescript
export async function GET(request: NextRequest) {
  try {
    const supabase = createServerClient()
    const url = new URL(request.url)
    const code = url.searchParams.get('code')

    if (code) {
      const result = await supabase
        .from('endmill_types')
        .select(`
          *,
          endmill_categories(code, name_ko),
          endmill_supplier_prices(
            unit_price,
            suppliers(code, name)
          ),
          cam_sheet_endmills(
            tool_life,
            t_number,
            cam_sheets(model, process)
          ),
          tool_positions(              // â† ì¶”ê°€!
            position_number,
            current_life,
            total_life,
            install_date,
            status,
            equipment:equipment_id(    // â† JOIN
              equipment_number,
              current_model,
              process
            )
          ),
          inventory(
            current_stock,
            min_stock,
            max_stock,
            status,
            location
          )
        `)
        .eq('code', code.toUpperCase())
        .single()

      endmillTypes = result.data
      error = result.error
    }

    // ë°ì´í„° ê°€ê³µ
    const processEndmill = (endmill: any) => {
      // CAM Sheet ì •ë³´ (ê¸°ì¡´)
      const camSheets = endmill.cam_sheet_endmills?.map((cs: any) => ({
        model: cs.cam_sheets?.model || '',
        process: cs.cam_sheets?.process || '',
        toolLife: cs.tool_life,
        tNumber: cs.t_number
      })) || []

      // ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© (ì‹ ê·œ) â† ì¶”ê°€!
      const currentUsage = endmill.tool_positions
        ?.filter((tp: any) => tp.status === 'active')
        ?.map((tp: any) => {
          // í˜„ì¬ ì„¤ë¹„ì˜ ëª¨ë¸/ê³µì •ì— ë§ëŠ” CAM Sheet ì‚¬ì–‘ ì°¾ê¸°
          const matchingCamSheet = endmill.cam_sheet_endmills?.find(
            (cs: any) =>
              cs.cam_sheets?.model === tp.equipment?.current_model &&
              cs.cam_sheets?.process === tp.equipment?.process
          )

          return {
            equipmentNumber: tp.equipment?.equipment_number,
            equipmentModel: tp.equipment?.current_model,
            equipmentProcess: tp.equipment?.process,
            positionNumber: tp.position_number,
            currentLife: tp.current_life,
            totalLife: tp.total_life,
            installDate: tp.install_date,
            status: tp.status,
            specToolLife: matchingCamSheet?.tool_life || null,
            usagePercentage: tp.total_life > 0
              ? Math.round((tp.current_life / tp.total_life) * 100)
              : 0
          }
        }) || []

      return {
        id: endmill.id,
        code: endmill.code,
        category: endmill.endmill_categories?.code || '',
        categoryName: endmill.endmill_categories?.name_ko || '',
        name: endmill.name,
        unitCost: endmill.unit_cost,
        standardLife: endmill.standard_life,
        suppliers: endmill.endmill_supplier_prices?.map((sp: any) => ({
          code: sp.suppliers?.code || '',
          name: sp.suppliers?.name || '',
          unitPrice: sp.unit_price
        })) || [],
        camSheets,           // CAM Sheet ì‚¬ì–‘ ì •ë³´ (ì •ì )
        currentUsage,        // ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© (ë™ì ) â† ì¶”ê°€!
        inventory: endmill.inventory ? {
          currentStock: endmill.inventory.current_stock,
          minStock: endmill.inventory.min_stock,
          maxStock: endmill.inventory.max_stock,
          status: endmill.inventory.status,
          location: endmill.inventory.location
        } : null,
        createdAt: endmill.created_at,
        updatedAt: endmill.updated_at
      }
    }

    const processedEndmills = code
      ? (endmillTypes ? [processEndmill(endmillTypes as any)] : [])
      : (Array.isArray(endmillTypes) ? endmillTypes.map(processEndmill) : [])

    return NextResponse.json({
      success: true,
      data: processedEndmills,
      count: processedEndmills.length
    })

  } catch (error) {
    logger.error('ì—”ë“œë°€ ì¡°íšŒ API ì˜¤ë¥˜:', error)
    return NextResponse.json(
      { error: error instanceof Error ? error.message : 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' },
      { status: 500 }
    )
  }
}
```

---

### Step 2: íƒ€ì… ì •ì˜ ì¶”ê°€

#### íŒŒì¼: `lib/types/endmill.ts`

```typescript
// ê¸°ì¡´ íƒ€ì…ì— ì¶”ê°€
export interface EndmillCurrentUsage {
  equipmentNumber: string
  equipmentModel: string
  equipmentProcess: string
  positionNumber: number
  currentLife: number
  totalLife: number
  installDate: string
  status: string
  specToolLife: number | null
  usagePercentage: number
}

export interface EndmillDetailInfo extends EndmillMaster {
  // ê¸°ì¡´ í•„ë“œë“¤...

  // CAM Sheet ì‚¬ì–‘ ì •ë³´ (ì •ì )
  camSheets: Array<{
    model: string
    process: string
    toolLife: number
    tNumber: number
  }>

  // ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© (ë™ì ) â† ì¶”ê°€!
  currentUsage: EndmillCurrentUsage[]

  // ê¸°íƒ€ í•„ë“œë“¤...
}
```

---

### Step 3: í”„ë¡ íŠ¸ì—”ë“œ ìˆ˜ì •

#### íŒŒì¼: `app/dashboard/endmill-detail/[code]/page.tsx`

```typescript
'use client'

import { useParams, useRouter } from 'next/navigation'
import { useState, useEffect } from 'react'
import { EndmillDetailInfo } from '../../../../lib/types/endmill'

export default function EndmillDetailPage() {
  const params = useParams()
  const endmillCode = params.code as string
  const [endmillData, setEndmillData] = useState<EndmillDetailInfo | null>(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    const fetchEndmillData = async () => {
      try {
        const response = await fetch(`/api/endmill?code=${endmillCode}`)
        const result = await response.json()

        if (result.success && result.data.length > 0) {
          setEndmillData(result.data[0])
        }
      } catch (error) {
        console.error('ë°ì´í„° ë¡œë”© ì˜¤ë¥˜:', error)
      } finally {
        setLoading(false)
      }
    }

    fetchEndmillData()
  }, [endmillCode])

  if (loading) return <div>ë¡œë”©ì¤‘...</div>
  if (!endmillData) return <div>ì•¤ë“œë°€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>

  return (
    <div className="min-h-screen bg-gray-50 p-6">
      <h1 className="text-2xl font-bold mb-6">
        {endmillData.code} - {endmillData.name}
      </h1>

      {/* ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© ì„¹ì…˜ (ì‹ ê·œ) */}
      <section className="bg-white rounded-lg shadow p-6 mb-6">
        <h2 className="text-xl font-semibold mb-4">
          ğŸ“Š ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© ({endmillData.currentUsage.length}ê°œ ì„¤ë¹„)
        </h2>

        {endmillData.currentUsage.length > 0 ? (
          <div className="overflow-x-auto">
            <table className="min-w-full divide-y divide-gray-200">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ì„¤ë¹„ë²ˆí˜¸
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ëª¨ë¸
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ê³µì •
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    Të²ˆí˜¸
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    í˜„ì¬ ìˆ˜ëª…
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ì´ ìˆ˜ëª…
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ì‚¬ì–‘ ìˆ˜ëª…
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ì‚¬ìš©ë¥ 
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ì„¤ì¹˜ì¼
                  </th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                {endmillData.currentUsage.map((usage, index) => (
                  <tr key={index} className="hover:bg-gray-50">
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                      {usage.equipmentNumber}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      {usage.equipmentModel}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      {usage.equipmentProcess}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      T{usage.positionNumber.toString().padStart(2, '0')}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      {usage.currentLife}íšŒ
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      {usage.totalLife}íšŒ
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {usage.specToolLife ? `${usage.specToolLife}íšŒ` : 'N/A'}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <div className="flex items-center">
                        <span className={`text-sm font-medium ${
                          usage.usagePercentage > 80 ? 'text-red-600' :
                          usage.usagePercentage > 50 ? 'text-yellow-600' :
                          'text-green-600'
                        }`}>
                          {usage.usagePercentage}%
                        </span>
                        <div className="ml-2 w-24 bg-gray-200 rounded-full h-2">
                          <div
                            className={`h-2 rounded-full ${
                              usage.usagePercentage > 80 ? 'bg-red-600' :
                              usage.usagePercentage > 50 ? 'bg-yellow-600' :
                              'bg-green-600'
                            }`}
                            style={{ width: `${usage.usagePercentage}%` }}
                          />
                        </div>
                      </div>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {new Date(usage.installDate).toLocaleDateString('ko-KR')}
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        ) : (
          <div className="text-center py-8 text-gray-500">
            í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ ì„¤ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤.
          </div>
        )}
      </section>

      {/* CAM Sheet ì‚¬ì–‘ ì •ë³´ (ê¸°ì¡´) */}
      <section className="bg-white rounded-lg shadow p-6">
        <h2 className="text-xl font-semibold mb-4">
          ğŸ“‹ ë“±ë¡ëœ CAM Sheet ì‚¬ì–‘
        </h2>

        {endmillData.camSheets.length > 0 ? (
          <div className="overflow-x-auto">
            <table className="min-w-full divide-y divide-gray-200">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ëª¨ë¸
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ê³µì •
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    T Number
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                    ì‚¬ì–‘ ìˆ˜ëª…
                  </th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                {endmillData.camSheets.map((sheet, index) => (
                  <tr key={index} className="hover:bg-gray-50">
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      {sheet.model}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      {sheet.process}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      T{sheet.tNumber.toString().padStart(2, '0')}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      {sheet.toolLife}íšŒ
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        ) : (
          <div className="text-center py-8 text-gray-500">
            ë“±ë¡ëœ CAM Sheet ì‚¬ì–‘ì´ ì—†ìŠµë‹ˆë‹¤.
          </div>
        )}
      </section>
    </div>
  )
}
```

---

### Step 4: ì„¤ë¹„ í˜ì´ì§€ ìˆ˜ì •

#### íŒŒì¼: `app/api/equipment/route.ts`

```typescript
export async function GET(request: NextRequest) {
  try {
    const supabase = createServerClient()
    const { searchParams } = new URL(request.url)
    const equipmentNumber = searchParams.get('equipmentNumber')

    if (equipmentNumber) {
      // íŠ¹ì • ì„¤ë¹„ ì¡°íšŒ
      const { data: equipment, error } = await supabase
        .from('equipment')
        .select(`
          *,
          tool_positions(
            position_number,
            current_life,
            total_life,
            install_date,
            status,
            endmill_types(
              id,
              code,
              name,
              endmill_categories(code, name_ko)
            )
          )
        `)
        .eq('equipment_number', equipmentNumber)
        .single()

      if (error) throw error

      // í˜„ì¬ ëª¨ë¸/ê³µì •ì— ë§ëŠ” CAM Sheet ì¡°íšŒ
      const { data: camSheet } = await supabase
        .from('cam_sheets')
        .select(`
          *,
          cam_sheet_endmills(
            t_number,
            tool_life,
            endmill_code,
            endmill_name,
            endmill_types(code, name)
          )
        `)
        .eq('model', equipment.current_model)
        .eq('process', equipment.process)
        .single()

      return NextResponse.json({
        success: true,
        data: {
          ...equipment,
          camSheet: camSheet || null
        }
      })
    }

    // ì „ì²´ ì„¤ë¹„ ëª©ë¡ ì¡°íšŒëŠ” ê¸°ì¡´ê³¼ ë™ì¼
    // ...
  } catch (error) {
    logger.error('ì„¤ë¹„ ì¡°íšŒ ì˜¤ë¥˜:', error)
    return NextResponse.json(
      { error: 'ì„¤ë¹„ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' },
      { status: 500 }
    )
  }
}
```

---

### Step 5: ê³µêµ¬ êµì²´ í”„ë¡œì„¸ìŠ¤ ìˆ˜ì •

#### íŒŒì¼: `app/api/tool-changes/route.ts`

```typescript
export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
    const supabase = createServerClient()

    // 1. tool_changes í…Œì´ë¸”ì— ê¸°ë¡ (ê¸°ì¡´)
    const { data: toolChange, error: changeError } = await supabase
      .from('tool_changes')
      .insert({
        equipment_id: body.equipment_id,
        position_number: body.position_number,
        old_endmill_id: body.old_endmill_id,
        new_endmill_id: body.new_endmill_id,
        change_reason: body.change_reason,
        changed_by: body.changed_by,
        previous_life: body.previous_life
      })
      .select()
      .single()

    if (changeError) throw changeError

    // 2. tool_positions ì—…ë°ì´íŠ¸ (ì‹ ê·œ ì¶”ê°€!)
    // ì„¤ë¹„ì˜ í˜„ì¬ ëª¨ë¸/ê³µì •ì— ë§ëŠ” CAM Sheet ì¡°íšŒ
    const { data: equipment } = await supabase
      .from('equipment')
      .select('current_model, process')
      .eq('id', body.equipment_id)
      .single()

    const { data: camSheetEndmill } = await supabase
      .from('cam_sheet_endmills')
      .select('tool_life, cam_sheets!inner(model, process)')
      .eq('endmill_type_id', body.new_endmill_id)
      .eq('cam_sheets.model', equipment.current_model)
      .eq('cam_sheets.process', equipment.process)
      .single()

    const specToolLife = camSheetEndmill?.tool_life || 2000 // ê¸°ë³¸ê°’

    const { error: positionError } = await supabase
      .from('tool_positions')
      .upsert({
        equipment_id: body.equipment_id,
        position_number: body.position_number,
        endmill_type_id: body.new_endmill_id,
        current_life: 0,
        total_life: specToolLife,
        install_date: new Date().toISOString(),
        status: 'active'
      }, {
        onConflict: 'equipment_id,position_number'
      })

    if (positionError) {
      logger.warn('tool_positions ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', positionError)
    }

    // 3. ì¬ê³  ê°ì†Œ (ê¸°ì¡´)
    const { error: inventoryError } = await supabase
      .from('inventory')
      .update({
        current_stock: supabase.raw('current_stock - 1')
      })
      .eq('endmill_type_id', body.new_endmill_id)

    if (inventoryError) {
      logger.warn('ì¬ê³  ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', inventoryError)
    }

    return NextResponse.json({
      success: true,
      data: toolChange,
      message: 'ê³µêµ¬ êµì²´ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.'
    })

  } catch (error) {
    logger.error('ê³µêµ¬ êµì²´ ì˜¤ë¥˜:', error)
    return NextResponse.json(
      { error: 'ê³µêµ¬ êµì²´ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' },
      { status: 500 }
    )
  }
}
```

---

### Step 6: ì„¤ë¹„ ë°°ì • ë³€ê²½ API ì¶”ê°€

#### íŒŒì¼: `app/api/equipment/[id]/assign/route.ts` (ì‹ ê·œ)

```typescript
import { NextRequest, NextResponse } from 'next/server'
import { createServerClient } from '../../../../../lib/supabase/client'
import { logger } from '@/lib/utils/logger'

// ì„¤ë¹„ ë°°ì • ë³€ê²½ (ëª¨ë¸/ê³µì • ë³€ê²½)
export async function PUT(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  try {
    const { current_model, process } = await request.json()
    const supabase = createServerClient()

    // 1. equipment í…Œì´ë¸” ì—…ë°ì´íŠ¸
    const { data: equipment, error: equipmentError } = await supabase
      .from('equipment')
      .update({
        current_model,
        process,
        updated_at: new Date().toISOString()
      })
      .eq('id', params.id)
      .select()
      .single()

    if (equipmentError) throw equipmentError

    // 2. tool_positionsì˜ total_lifeë¥¼ ìƒˆ CAM Sheet ì‚¬ì–‘ì— ë§ê²Œ ì—…ë°ì´íŠ¸
    const { data: toolPositions } = await supabase
      .from('tool_positions')
      .select('id, endmill_type_id, position_number')
      .eq('equipment_id', params.id)
      .eq('status', 'active')

    if (toolPositions && toolPositions.length > 0) {
      for (const position of toolPositions) {
        // ìƒˆ ëª¨ë¸/ê³µì •ì— ë§ëŠ” CAM Sheet ì‚¬ì–‘ ì¡°íšŒ
        const { data: camSheetEndmill } = await supabase
          .from('cam_sheet_endmills')
          .select('tool_life, cam_sheets!inner(model, process)')
          .eq('endmill_type_id', position.endmill_type_id)
          .eq('cam_sheets.model', current_model)
          .eq('cam_sheets.process', process)
          .single()

        if (camSheetEndmill) {
          // total_life ì—…ë°ì´íŠ¸
          await supabase
            .from('tool_positions')
            .update({
              total_life: camSheetEndmill.tool_life
            })
            .eq('id', position.id)
        }
      }
    }

    return NextResponse.json({
      success: true,
      data: equipment,
      message: 'ì„¤ë¹„ ë°°ì •ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.'
    })

  } catch (error) {
    logger.error('ì„¤ë¹„ ë°°ì • ë³€ê²½ ì˜¤ë¥˜:', error)
    return NextResponse.json(
      { error: 'ì„¤ë¹„ ë°°ì • ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' },
      { status: 500 }
    )
  }
}
```

---

## ğŸ“… 7ë‹¨ê³„: êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1 (ê³ ìš°ì„ ìˆœìœ„): í•µì‹¬ ì—°ê²°

**ê¸°ê°„:** Week 1-2

**ì‘ì—… ëª©ë¡:**
- [ ] tool_positions ë°ì´í„° ì •í•©ì„± í™•ì¸
- [ ] API ìˆ˜ì •: `/api/endmill` (currentUsage ì¶”ê°€)
- [ ] íƒ€ì… ì •ì˜ ì¶”ê°€: `EndmillCurrentUsage`
- [ ] ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ UI ìˆ˜ì •
- [ ] í…ŒìŠ¤íŠ¸: ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© í‘œì‹œ í™•ì¸

**ëª©í‘œ:** ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ì—ì„œ ì‹¤ì œ ì‚¬ìš© ì„¤ë¹„ í™•ì¸ ê°€ëŠ¥

---

### Phase 2 (ì¤‘ìš°ì„ ìˆœìœ„): ì–‘ë°©í–¥ ì—°ê²°

**ê¸°ê°„:** Week 3-4

**ì‘ì—… ëª©ë¡:**
- [ ] API ìˆ˜ì •: `/api/equipment` (tool_positions ì¡°íšŒ)
- [ ] ì„¤ë¹„ ìƒì„¸ í˜ì´ì§€ ìˆ˜ì •
- [ ] ì„¤ë¹„ ëª¨ë¸/ê³µì • ë³€ê²½ API ìƒì„± (`/api/equipment/[id]/assign`)
- [ ] ì„¤ë¹„ ëª¨ë¸/ê³µì • ë³€ê²½ ì‹œ CAM Sheet ìë™ ë§¤ì¹­
- [ ] í…ŒìŠ¤íŠ¸: ì„¤ë¹„ í˜ì´ì§€ì—ì„œ ì¥ì°©ëœ ì•¤ë“œë°€ í™•ì¸

**ëª©í‘œ:** ì„¤ë¹„ â†” ì•¤ë“œë°€ ì–‘ë°©í–¥ í™•ì¸ ê°€ëŠ¥

---

### Phase 3 (í•„ìˆ˜): ë°ì´í„° ë™ê¸°í™”

**ê¸°ê°„:** Week 5

**ì‘ì—… ëª©ë¡:**
- [ ] ê³µêµ¬ êµì²´ API ìˆ˜ì • (tool_positions ì—…ë°ì´íŠ¸)
- [ ] ì„¤ë¹„ ë°°ì • ë³€ê²½ ì‹œ total_life ìë™ ì—…ë°ì´íŠ¸
- [ ] ì‹¤ì‹œê°„ ë™ê¸°í™” í…ŒìŠ¤íŠ¸
- [ ] ë°ì´í„° ì •í•©ì„± ê²€ì¦

**ëª©í‘œ:** ëª¨ë“  ë³€ê²½ì‚¬í•­ì´ ì‹¤ì‹œê°„ ë°˜ì˜

---

### Phase 4 (ê°œì„ ): ëŒ€ì‹œë³´ë“œ & ë¦¬í¬íŠ¸

**ê¸°ê°„:** Week 6

**ì‘ì—… ëª©ë¡:**
- [ ] ëŒ€ì‹œë³´ë“œ ìˆ˜ì •: ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© ë°˜ì˜
- [ ] ë¦¬í¬íŠ¸ ìˆ˜ì •: ì„¤ë¹„ë³„ ì•¤ë“œë°€ ì‚¬ìš© ì´ë ¥
- [ ] ì„±ëŠ¥ ìµœì í™” (800ëŒ€ ì„¤ë¹„ ëŒ€ì‘)
- [ ] ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸

**ëª©í‘œ:** ëª¨ë“  í˜ì´ì§€ ë°ì´í„° ì¼ê´€ì„± í™•ë³´

---

## ğŸ§ª 8ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì„¤ë¹„ ë°°ì • ë³€ê²½

**Given:** ì„¤ë¹„ C001ì´ PA1+CNC1 ìƒì‚° ì¤‘, AL002 ì‚¬ìš© ì¤‘

**When:** ì„¤ë¹„ë¥¼ R13+CNC2ë¡œ ë³€ê²½

**Then:**
- âœ… equipment í…Œì´ë¸” ì—…ë°ì´íŠ¸: `current_model=R13, process=CNC2`
- âœ… tool_positionsì˜ total_lifeê°€ R13+CNC2 ì‚¬ì–‘ìœ¼ë¡œ ì—…ë°ì´íŠ¸
- âœ… ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ì—ì„œ C001ì´ R13+CNC2ë¡œ í‘œì‹œ
- âœ… CAM Sheetì˜ R13+CNC2 ì‚¬ì–‘ì´ ìë™ ì ìš©

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: ê³µêµ¬ êµì²´

**Given:** ì„¤ë¹„ C001ì˜ T15ì— AL002 ì¥ì°© (R13+CNC2 ìƒì‚° ì¤‘)

**When:** AL002ë¥¼ AL005ë¡œ êµì²´

**Then:**
- âœ… tool_changes í…Œì´ë¸”ì— êµì²´ ê¸°ë¡
- âœ… tool_positions ì—…ë°ì´íŠ¸: endmill_type_id=AL005, current_life=0, total_life=R13+CNC2 ì‚¬ì–‘
- âœ… inventory í…Œì´ë¸”: AL005 ì¬ê³  ê°ì†Œ
- âœ… ì•¤ë“œë°€ ìƒì„¸(AL002)ì—ì„œ C001 ì œê±°
- âœ… ì•¤ë“œë°€ ìƒì„¸(AL005)ì—ì„œ C001 ì¶”ê°€

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: ìƒˆ CAM Sheet ì¶”ê°€

**Given:**
- AL002ê°€ PA1+CNC1, R13+CNC2ì—ë§Œ ë“±ë¡
- ì„¤ë¹„ C050ì´ PA1+CNC4 ìƒì‚° ì¤‘, AL002 ì‚¬ìš© ì¤‘

**When:** PA1+CNC4 CAM Sheet ì¶”ê°€ (AL002 í¬í•¨, Tool Life=450)

**Then:**
- âœ… cam_sheets í…Œì´ë¸”ì— PA1+CNC4 ì¶”ê°€
- âœ… cam_sheet_endmills í…Œì´ë¸”ì— ë§¤í•‘ ì¶”ê°€
- âœ… ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ "ë“±ë¡ëœ CAM Sheet ì‚¬ì–‘"ì— PA1+CNC4 í‘œì‹œ
- âœ… ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ "ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™©"ì— C050ì´ PA1+CNC4ë¡œ í‘œì‹œ
- âœ… C050ì˜ tool_positions total_lifeê°€ 450ìœ¼ë¡œ ì—…ë°ì´íŠ¸

---

### ì‹œë‚˜ë¦¬ì˜¤ 4: ì„¤ë¹„ ì¡°íšŒ

**Given:** ì„¤ë¹„ C001ì— ì—¬ëŸ¬ ì•¤ë“œë°€ ì¥ì°©

**When:** ì„¤ë¹„ ìƒì„¸ í˜ì´ì§€ ì¡°íšŒ

**Then:**
- âœ… í˜„ì¬ ëª¨ë¸/ê³µì • í‘œì‹œ
- âœ… ì¥ì°©ëœ ì•¤ë“œë°€ ëª©ë¡ í‘œì‹œ (T01~T24)
- âœ… ê° ì•¤ë“œë°€ì˜ í˜„ì¬ ìˆ˜ëª…/ì´ ìˆ˜ëª… í‘œì‹œ
- âœ… í˜„ì¬ ëª¨ë¸/ê³µì •ì— ë§ëŠ” CAM Sheet ì‚¬ì–‘ í‘œì‹œ

---

## ğŸ¯ 9ë‹¨ê³„: ìµœì¢… ê²°ê³¼ë¬¼

### ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ ìµœì¢… êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AL002 - BULL NOSE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ ğŸ“Š ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© (5ê°œ ì„¤ë¹„)              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ ì„¤ë¹„  â”‚ëª¨ë¸ â”‚ê³µì • â”‚Të²ˆí˜¸â”‚ ìˆ˜ëª… â”‚ì‚¬ìš©ë¥ â”‚   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ â”‚ C001  â”‚ R13 â”‚CNC2 â”‚T15 â”‚450/600â”‚ 75% â”‚   â”‚
â”‚ â”‚ C025  â”‚ PA1 â”‚CNC1 â”‚T12 â”‚380/500â”‚ 76% â”‚   â”‚
â”‚ â”‚ C150  â”‚ R13 â”‚CNC2 â”‚T15 â”‚200/600â”‚ 33% â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜    â”‚
â”‚ â† ì´ê²ƒì´ ì‹¤ì‹œê°„ ë™ì  ì •ë³´                    â”‚
â”‚                                             â”‚
â”‚ ğŸ“‹ ë“±ë¡ëœ CAM Sheet ì‚¬ì–‘                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚ â”‚ëª¨ë¸ â”‚ê³µì • â”‚ ì‚¬ì–‘ ìˆ˜ëª…   â”‚                 â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚ â”‚ PA1 â”‚CNC1 â”‚ 500íšŒ      â”‚                 â”‚
â”‚ â”‚ PA1 â”‚CNC2 â”‚ 500íšŒ      â”‚                 â”‚
â”‚ â”‚ R13 â”‚CNC1 â”‚ 123íšŒ      â”‚                 â”‚
â”‚ â”‚ R13 â”‚CNC2 â”‚ 600íšŒ      â”‚                 â”‚
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚ â† ì´ê²ƒì´ CAM Sheet ì •ì  ì •ë³´                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ì„¤ë¹„ ìƒì„¸ í˜ì´ì§€ ìµœì¢… êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„¤ë¹„ C001                                   â”‚
â”‚ í˜„ì¬ ìƒì‚°: R13 - CNC2                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ ğŸ”§ ì¥ì°©ëœ ì•¤ë“œë°€ (21ê°œ í¬ì§€ì…˜)              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ â”‚Të²ˆí˜¸â”‚ì•¤ë“œë°€  â”‚ì¹´í…Œê³ ë¦¬â”‚ ìˆ˜ëª… â”‚ì‚¬ìš©ë¥ â”‚      â”‚
â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚ â”‚T01 â”‚AL005   â”‚FLAT  â”‚100/500â”‚ 20% â”‚       â”‚
â”‚ â”‚T02 â”‚AL010   â”‚BALL  â”‚250/400â”‚ 63% â”‚       â”‚
â”‚ â”‚...â”‚        â”‚      â”‚      â”‚     â”‚       â”‚
â”‚ â”‚T15 â”‚AL002   â”‚B.NOSEâ”‚450/600â”‚ 75% â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                             â”‚
â”‚ ğŸ“‹ í˜„ì¬ ëª¨ë¸/ê³µì •ì˜ CAM Sheet ì‚¬ì–‘           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚ â”‚Të²ˆí˜¸â”‚ì•¤ë“œë°€  â”‚ì‚¬ì–‘ìˆ˜ëª…â”‚                    â”‚
â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤                     â”‚
â”‚ â”‚T01 â”‚AL005   â”‚500íšŒ â”‚                     â”‚
â”‚ â”‚T02 â”‚AL010   â”‚400íšŒ â”‚                     â”‚
â”‚ â”‚T15 â”‚AL002   â”‚600íšŒ â”‚                     â”‚
â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… 10ë‹¨ê³„: ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°ì´í„°ë² ì´ìŠ¤
- [ ] tool_positionsì— ëª¨ë“  ì„¤ë¹„ì˜ ì‹¤ì œ ì¥ì°© ì •ë³´ ì…ë ¥
- [ ] equipmentì˜ current_model, process ì •í™•ì„± í™•ì¸
- [ ] cam_sheet_endmillsì— ëª¨ë“  ëª¨ë¸/ê³µì • ì¡°í•© ë“±ë¡
- [ ] ë°ì´í„° ì •í•©ì„± ê²€ì¦ ì¿¼ë¦¬ ì‹¤í–‰

### API
- [ ] `/api/endmill` - tool_positions ì¡°íšŒ ì¶”ê°€
- [ ] `/api/equipment` - tool_positions ì¡°íšŒ ì¶”ê°€
- [ ] `/api/tool-changes` - tool_positions ì—…ë°ì´íŠ¸ ì¶”ê°€
- [ ] `/api/equipment/[id]/assign` - ì„¤ë¹„ ë°°ì • ë³€ê²½ API ìƒì„±
- [ ] ëª¨ë“  API ì‘ë‹µ íƒ€ì… ì •ì˜ ì—…ë°ì´íŠ¸

### í”„ë¡ íŠ¸ì—”ë“œ
- [ ] ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ - ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© ì„¹ì…˜ ì¶”ê°€
- [ ] ì„¤ë¹„ ìƒì„¸ í˜ì´ì§€ - ì¥ì°©ëœ ì•¤ë“œë°€ ëª©ë¡ í‘œì‹œ
- [ ] ê³µêµ¬ êµì²´ í˜ì´ì§€ - tool_positions ë™ê¸°í™”
- [ ] ëŒ€ì‹œë³´ë“œ - ì‹¤ì‹œê°„ ë°ì´í„° ë°˜ì˜
- [ ] ë¡œë”© ìƒíƒœ ë° ì—ëŸ¬ ì²˜ë¦¬

### í…ŒìŠ¤íŠ¸
- [ ] ì„¤ë¹„ ë°°ì • ë³€ê²½ â†’ ì•¤ë“œë°€ í˜ì´ì§€ ìë™ ë°˜ì˜
- [ ] ê³µêµ¬ êµì²´ â†’ ì–‘ìª½ í˜ì´ì§€ ë™ê¸°í™”
- [ ] CAM Sheet ì¶”ê°€ â†’ ì‚¬ì–‘ ì •ë³´ í‘œì‹œ
- [ ] ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (800ëŒ€ ì„¤ë¹„ ëŒ€ì‘)
- [ ] ë™ì‹œì„± í…ŒìŠ¤íŠ¸ (ì—¬ëŸ¬ ì‚¬ìš©ì ë™ì‹œ ìˆ˜ì •)

### ë¬¸ì„œí™”
- [ ] API ë¬¸ì„œ ì—…ë°ì´íŠ¸
- [ ] ë°ì´í„° íë¦„ë„ ì‘ì„±
- [ ] ì‚¬ìš©ì ê°€ì´ë“œ ì—…ë°ì´íŠ¸
- [ ] ê°œë°œì ê°€ì´ë“œ ì—…ë°ì´íŠ¸

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

1. **Phase 1 ì°©ìˆ˜**: ì•¤ë“œë°€ ìƒì„¸ í˜ì´ì§€ ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© ì¶”ê°€
2. **ë°ì´í„° ê²€ì¦**: tool_positions í…Œì´ë¸” ë°ì´í„° ì •í•©ì„± í™•ì¸
3. **ì ì§„ì  ë°°í¬**: Phaseë³„ë¡œ ìˆœì°¨ì ìœ¼ë¡œ ë°°í¬ ë° í…ŒìŠ¤íŠ¸
4. **ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘**: ì‹¤ì œ ì‚¬ìš©ì í…ŒìŠ¤íŠ¸ ë° ê°œì„ 

---

## ğŸ“š ì°¸ê³  ìë£Œ

- PRD ë¬¸ì„œ
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ: `lib/types/database.ts`
- ê¸°ì¡´ API: `app/api/endmill/route.ts`
- ì„¤ë¹„ API: `app/api/equipment/route.ts`
- ê³µêµ¬ êµì²´ API: `app/api/tool-changes/route.ts`

---

**ì‘ì„±ì¼:** 2025-10-10
**ë²„ì „:** 1.0
**ìƒíƒœ:** ê³„íš ë‹¨ê³„
